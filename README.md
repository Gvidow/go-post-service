# Систему для добавления и чтения постов и комментариев

### Схема

[Схема GraphQL](./api/graphql/gqlgen.yml)

### Запуск

```
make build
./bin/app
```

При запуске бинаря можно передать флаг `--config`. По умолчанию берется configs/config.yaml конфиг.

Для хранения данных сервис поддерживает два репозитория:
- memory
- postgres

Для выбора репозитория достаточно поменять [конфиг](./configs/config.yaml)

Для запуска в Docker контейнере:
```
docker-compose --file deployments/docker-compose.yml up
```

Для смены конфига сервиса нужно поменять файл `configs/config.yaml` в контейнере `post-service`.

Также можно запустить контейнер с загруженного [образа](https://hub.docker.com/r/gvidoj/post-service).

### О сервисе
Выдача постов происход в порядке даты и времени их публикации от самого свежего.

Иерархическая структура комментариев выдается списком комментариев с указанием глубины и родителя, порядок совпадает с прямым обходом дерева. Т.е. сначала идет самый свежий комментарий и ответы к нему, потом следующий комментарий.

(*) Размер вложенности можно регулировать парамметром `depth`, по умолчанию он принимает значение  -1, т.е. без ограничения по глубине вложенности, значение 1 соответсвует возвращению комментариев без ответов на них.
